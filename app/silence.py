#          ████████     ██████
#         █░░░░░░░░██_██░░░░░░█
#        █░░░░░░░░░░░█░░░░░░░░░█
#       █░░░░░░░███░░░█░░░░░░░░░█
#       █░░░░███░░░███░█░░░████░█
#     █░░░██░░░░░░░░███░██░░░░██
#    █░░░░░░░░░░░░░░░░░█░░░░░░░░███
#    █░░░░░░░░░░░░░██████░░░░░████░░█
#    █░░░░░░░░░█████░░░████░░██░░██░░█
#   ██░░░░░░░███░░░░░░░░░░█░░░░░░░░███
#  █░░░░░░░░░░░░░░█████████░░█████████
# █░░░░░░░░░░█████ ████   ████ █████ █
# █░░░░░░░░░░█      █ ███   █   ███ █ █
#█░░░░░░░░░░░░█   ████ ████    ██ ████
#░░░░░░░░░░░░░█████████░░░████████░░░█
#░░░░░░░░░░░░░░░░█░░░░░█░░░░░░░░░░░░█
#░░░░░░░░░░░░░░░░░░░░██░░░░█░░░░░░██
#░░░░░░░░░░░░░░░░░░██░░░░░░░███████
#░░░░░░░░░░░░░░░░██░░░░░░░░░░█░░░░░█                                            _____                                 _____                                            _____                                                   _____
#░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░█                                          /\    \                               /\    \                                          /\    \                                                 /\    \
#░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░█                       :  :                  / :  : \    \                             / :  : \    \                                        / :  : \____\                                               / :  : \____\
#░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░█                                        / :  :  :  : \    \                           / :  :  :  : \    \            :  :  :           :  :             :  :  :   :  : /    /                          :                     :  :   :  : /    /
#░░░░░░░░░░░█████████░░░░░░░░░░░░░░██                                       / :  :  :  :  :  : \    \                         / :  :  :  :  :  : \    \                                :  :  :   :   :  :  : /    /                                              / :  :  : /    /
#░░░░░░░░░░█▒▒▒▒▒▒▒▒███████████████▒▒█                                     / :  :  : /\ :  :  : \    \                     :  :   :  :  :  : /\ :  :  : \    \                                  / :  :  : /    /                                              / :  :  : /    /
#░░░░░░░░░█▒▒███████▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒█                                    / :  :  : /__\ :  :  : \    \                     / :  :  : /__\ :  :  : \    \                                / :  :  : /    /                                             :  :  :  :   : /____/
#░░░░░░░░░█▒▒▒█▓▓▓▓██████████████████                                    / :  :  :  : \   \ :  :  : \    \                   / :  :  :  : \   \ :  :  : \    \                              / :  :  : /    /                                              / :  :  :  : \    \
#░░░░░░░░░██▒▒█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█                                       / :  :  :  :  :  : \   \ :  :  : \    \                 / :  :  :  :  :  : \   \ :  :  : \    \                            / :        /      _____                                   / :  :  :  :  :  : \    \   _____
#░░░░░░░░░░█▒▒█▓█████████████████ ████                                 / :  :  : /\ :  :  : \   \ :  :  : \ ___\               / :  :  : /\ :  :  : \   \ :  :  : \____\                          / :  :  : /____/      /\    \                                 / :  :  : /\ :  :  : \    \ /\    \
#░░░░░░░░░░█▒▒██▓▓▒▓▒▓▒▓▒▒▒▒▒▒▒▒▓█▓▒▒▒█                               / :  :  : /__\ :  :  : \   \ :  :  : |    |             / :  :  : /  \ :  :  : \   \ :  :  : |    |                          :  :  : |    /      / :  : \____\                         :  :  :  :  :  :  :   :  :  : /  :   :  :  : \    / :  : \____\
#░░░░░░░░░█▒▒████████▓▒███▓██▒▒▒▒▒▒▒▒▒█                   :             \ :  :  : \   \ :  :  : \  / :  :  : |____|             \ :  : /   | :  :  :  : \  / :  :  : |____|                       :   :  :   : |____\     / :  :  : /    /                               \ :  : /    \ :  :  : \ :   :  :  :  : /    /
#░░░░░░░░░█▒▒▒▒▒▒▒▒▒█████████████▓█▓██                                 \ :  :  : \   \ :  :  : \/ :  :  : /    /               \/____| :  :  :  :  : \/ :  :  : /    /                          \ :  :  : \    \   / :  :  : /    /                                 \/____/ :   :  :  : \/ :  :  : /    /
#░░░░░░░░░░████████▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒█                                  \ :  :  : \   \ :  :  :  :  :  : /    /                      | :  :  :  :  :  :  :  :  : /    /                            \ :  :  : \    :  :   :   :  : /    /                                  :    :    :   :   :  :  :  :  :  :  : /    /
#░░░░░░░░░░░░░░░░░░██████████████████                                    \ :  :  : \   \ :  :  :  : /    /           :    :          | :  : |\ :  :  :  : /    /            :  :                  \ :  :  : \    / :  :  : /    /                :  :  :  :                           \ :  :        /
#░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░█             :  :                            \ :  :  : \  / :  :  : /    /                       :  :   :  : | \ :  : /____/                                \ :  :  : \__/ :  :  : /    /                                              / :  :  : /    /
#██░░░░░░░░░░░░░░░░░░░░░░░░░░░██                                           \ :  :  : \/ :  :  : /    /                         | :  : |  ~|                                       \ :  :  :  :  :  :  :  : /    /                                              :   :  :  : /    /
#▓██░░░░░░░░░░░░░░░░░░░░░░░░██                                              \ :  :  :  :  :  : /    /                          | :  : |   |                                        \ :  :  :  :  :  : /    /                                              / :  :  : /    /
#▓▓▓███░░░░░░░░░░░░░░░░░░░░█                                                 \ :  :  :  : /    /                           \ :  : |   |                                         \ :  :  :  : /    /                               :  :  :   :            / :  :  : /    /
#▓▓▓▓▓▓███░░░░░░░░░░░░░░░██                                  :                  \ :  : /____/             :                 \ : |   |                :      :  :  :  :                   \ :  : /____/                                               \ :  : /    /
#▓▓▓▓▓▓▓▓▓███████████████▓▓█                                                   ⠋                                     \|___|                                           ⠩                                                      \/____/
#▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓██
#▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█                                                                                                                                                                                                                                               |                                                                    |                                      |
#▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█                                                                    |                                                                                                             |
#______________________________                                                                                                                       |                                                                                                                      |                                                                                                                                              |                    |
#___________________________
#_ ______ _____ _________
# /            /                                                         |                                |                       |                    |                |                       |                    |                |                       |                    |                     |                       |                    |

#        \                          |                                |                                               |  |                                          |                    |                                          |                       |                    |  |                                           |                    |        |                    |                              |


#      |               |                                 |

#                  |                                                |            |                                   |                               |                           |                               |                           |                               |                                |                               |
#           |                                  |                                     |

#                  |                     |                                                     |                                   |                               |     |                                   |                               |     |                                   |                               |          |                                   |                               |
#   |                          |                       |                    |
#           |                                    |                                         |     |                    |                                    | |     |                    |                                    | |     |                    |                                    |      |     |                                                        |
#      |                        |                                 |      |                                |                       |                    |                |                       |                    |                |                       |                    |                     |                       |                    |

#                      |                                                |      |                                   |                               |                         |                               |                         |                               |                              |                               |
#           |                                   |                               |                   |                                |                       |                    |          |                                |                       |                    |          |                                |                       |                    |               |                                |                                        |

#                  |                     |
#   |                                |                       |                    |            |                                |                       |                    |     |                                |                       |                    |     |                                |                       |                              |                                |
#           |                               |                                         |                              |                       |                    |                           |                       |                    |                           |                       |                    |                                |                       |                    |

#   |         |                                   PRESENTATION                                                |                                |                    |   |                                |                    |   |                                |                    |        |                                |                    |
#                                                                                                                               |                               |     |                                   |                               |     |                                   |                               |          |                                   |                               |
#                |                            |                 |                          |                                                                              |                               |     |                                   |                               |     |                                   |                               |          |                                   |                               |

#        |                         This little tool will remove all comments

#                              at beginning and end of the choosen PYTHON scripts.                     |                                           |               |                                           |               |                                           |                    |                                           |

#              |        It will also keep line breaks and remove useless one (more than 3).                                             |                       |                    |                         |                       |                    |                         |                       |                    |                              |                       |                    |

#     |                 |                               |     -      |                                                                                             |                               |     |                                   |                               |     |                                   |                               |          |                                   |                               |

#      |                        |                                         |                                |                       |                    |                |                       |                    |                |                       |                    |                    |                                           |

#                   |            |                   Anyway          |                        |                                         |                                |                       |                    |                |                       |                    |                |                       |                    |                    |

#              |                      |                 have                                                 |                        |                                         |                                |                       |                    |                |                       |                    |                |                       |                    |                     |                                           |


#                 |                                  FUN         |                        |                                         |                                |                       |                    |                |                       |                    |                |                       |                    |                    |                                                                      |

#                                                         =)

#
#                                |                      or                                       |                                                            |                    |                |                       |                    |                |                       |                    |                    |                                           |


#              |                              |       DIE ! !         |                       |                            |                |                       |                    |                |                       |                    |                    |                                           |#      |                        |                                         |                                |

#
#                                                     !                                       |                                |                    |  |                                |                    |  |                                |                    |       |                                |                    |

#      |               |                                 !

#                  |                                                |            |                                   |                               |                           |                               |                           |                               |                                |                               |
#           |                                  !                                     |

#                  |                     |                                                     |                                   |                               |     |                                   |                               |     |                                   |                               |          |                                   |                               |
#   |                          |                       |                    |
#           |                                    |                                         |     |                    |                                    | |     |                    |                                    | |     |                    |                                    |      |     |                    |                                    |
#      |                        |                                 |      |                                |                       |                    |                |                       |                    |                |                       |                    |                    |                                           |

#                      |                                                |      |                                   |                               |                         |                               |                         |                               |                              |                               |
#           |                                   |                               |                   |                                |                       |                    |          |                                |                       |                    |          |                                |                       |                    |               |                                                                |

#                  |                     |
#   |                                |                       |                    |            |                                |                       |                    |     |                                |                       |                    |                                    |                       |                              |                                                                        |
#           |                               |                                         |                              |                       |                    |                           |                       |                    |                           |                       |                    |                                |                       |                    |

#_ _  _ ____ ___ ____ _    _    ____ ___ _ ____ _  _
#| |\ | [__   |  |__| |    |    |__|  |  | |  | |\ |
#| | \| ___]  |  |  | |___ |___ |  |  |  | |__| | \|


#ALEXANDRIA

import sys
import re
from PyQt5.QtWidgets import QApplication, QMainWindow, QPushButton, QFileDialog, QVBoxLayout, QWidget, QMessageBox


#___  ____ _ _ _ ____ ____    ___  _    ____ _  _ ___
#|__] |  | | | | |___ |__/    |__] |    |__| |\ |  |
#|    |__| |_|_| |___ |  \    |    |___ |  | | \|  |

#OPENING | https : //www.youtube.com/watch?v=_85LaeTCtV8  : 3


# The function to remove all comments and useless line breaks.
def remover(input_path, output_path)  :  
    with open(input_path, "r") as file :  
        lines = file.readlines()

    result = []  #The result will be written in a an empty list .
    check = False  #variable to tknow if there are comments at end of code lines .
    breaklines = 0 # We want to keep line breaks but not more than 3 .
    breaklines_max = 3

    for line in lines :  #Now we are checking beggining and ending of all linees to know if there are comments to remove
        stripped = line.strip()

        if check : 
            if stripped.startswith("'''") or stripped.startswith('"""') : 
                check = False
            continue #So if there are comments in the beginning og the line, we're going to uncomment

        elif stripped.endswith("'''") or stripped.endswith('"""'):  
            check = True
            continue #So if there are comments at the end ...

        else : 
            stripped = re.sub(r'#.*', '', line) #replace all text after "#" in "line" with an empty string then save the result in "stripped"

            if stripped != "" :  #Count empty lines number.
                if stripped.strip() == "": 
                    breaklines += 1

                else :  #Add new lines if needed
                    if breaklines > 0 : 
                        result.extend(["\n"] * min(breaklines, breaklines_max))
                        breaklines = 0
                    result.append(stripped) #Put all in result

    with open(output_path, "w") as file :  #Create the new file as asked in the program
        file.writelines(result)


#___  ____ ____ ____ ____ ____ _  _
#|__] |__/ |  | | __ |__/ |__| |\/|
#|    |  \ |__| |__] |  \ |  | |  |

#Initialize the Graphical Users Interface (GUI)
class MainWindow(QMainWindow)  :  
    def __init__(self):  
        super().__init__()
        self.init_ui()
    
    def init_ui(self)  :  

#Here are the main functions of the window, as the title
        self.setWindowTitle("Remove comments")

# Here the selecter button 
        btn_input = QPushButton("Select commented file", self)
        btn_input.clicked.connect(self.get_intput)

#The button to choose the path to save the file
        btn_output = QPushButton("Select output file", self)
        btn_output.clicked.connect(self.get_output)

#Then the button to run the script
        runner = QPushButton("Run", self)
        runner.clicked.connect(self.run)

#Now we place elements in the layout
        layout = QVBoxLayout()
        layout.addWidget(btn_input)
        layout.addWidget(btn_output)
        layout.addWidget(runner)

# centralize our diffrents buttons
        widget = QWidget(self)
        widget.setLayout(layout)
        self.setCentralWidget(widget)


#Function to get the path of our input file
    def get_intput(self):  
        options = QFileDialog.Options() 
        options |= QFileDialog.ReadOnly
        self.input, _ = QFileDialog.getOpenFileName(self, "Select Source File", "", "Python Files (*.py);;All Files (*)", options=options)


#Function to get the path of our output
    def get_output(self)  :  
        options = QFileDialog.Options()
        options |= QFileDialog.ReadOnly
        self.destination_file, _ = QFileDialog.getSaveFileName(self, "Select Destination File", "", "Python Files (*.py);;All Files (*)", options=options)

#Function to launch the comment remover
    def run(self):  
        remover(self.input, self.destination_file)
        QMessageBox.information(self, "Yummyyy !!!", "No more comments.") #Display a pop up if script as been executed correctly with yummy title, and description



#____ ____ ____ _  _ ____ ___    _    ____ _  _ _  _ ____ _  _
#|__/ |  | |    |_/  |___  |     |    |__| |  | |\ | |    |__|
#|  \ |__| |___ | \_ |___  |     |___ |  | |__| | \| |___ |  |

#ENDING | https : //www.youtube.com/watch?v=_85LaeTCtV8  : 3

if __name__ == '__main__'  :  
    app = QApplication(sys.argv)
    window = MainWindow()
    window.show()
    sys.exit(app.exec_())
